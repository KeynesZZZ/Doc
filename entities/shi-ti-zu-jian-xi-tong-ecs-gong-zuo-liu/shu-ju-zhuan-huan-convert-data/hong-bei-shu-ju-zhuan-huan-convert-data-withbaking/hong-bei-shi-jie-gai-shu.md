# 烘焙世界概述

Unity 在隔离状态下烘焙每个实体场景。后台导入器一次只处理一个场景，但当 Unity 编辑器实时烘焙打开的子场景时，它依赖于独立的世界来进行隔离。每个实时烘焙的子场景使用两个世界：

* **转换世界（Conversion World）**：烘焙发生的世界。bakers 和烘焙系统在这个世界中运行。
* **影子世界（Shadow World）**：包含之前烘焙输出副本的世界。Unity 使用影子世界来比较自上次烘焙以来的变化。

### 转换世界与影子世界

#### 转换世界

Unity 在转换世界中为场景中的每个创作 GameObject 创建实体，并在同一个世界中运行 bakers 和烘焙系统。因为实时烘焙尝试限制其工作量，所以烘焙场景的结果会保留在转换世界中，只要你保持子场景打开。

#### 影子世界

影子世界包含之前烘焙输出的副本。在新的烘焙通道结束时，Unity 会检查转换世界的内容与影子世界的内容。如果有变化，则将不同的实体和组件复制到主世界，并更新影子世界以匹配当前的转换世界。

### 实时烘焙流程

1. **创建转换世界**：Unity 为场景中的每个创作 GameObject 在转换世界中创建实体，并运行 bakers 和烘焙系统。
2. **保留烘焙结果**：烘焙场景的结果保留在转换世界中，只要子场景是打开状态。
3. **比较和复制数据**：
   * 在每次新的烘焙通道结束时，Unity 比较转换世界与影子世界的内容。
   * 复制有差异的实体和组件到主世界。
   * 更新影子世界以匹配当前的转换世界。

### 示例场景

假设你的项目处于播放模式，玩家已经清空了宝箱。如果创作 GameObject 的变换被改变，Unity 只需要将变换影响的 ECS 组件复制到主世界。移动宝箱不应该重置其内容，这就是影子世界的作用所在。

影子世界包含之前烘焙的输出副本。在新的烘焙通道结束时，Unity 检查转换世界对比影子世界的内容，并只复制不同的实体和组件到主世界，然后更新影子世界以匹配当前的转换世界。

### 总结

* **转换世界**：烘焙发生的主要世界，bakers 和烘焙系统在此运行。
* **影子世界**：存储之前烘焙输出副本，用于比较和检测变化。

这种机制允许 Unity 在最小化工作的同时，确保数据的一致性和正确的增量更新。
